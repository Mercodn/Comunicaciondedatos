DOCUMENTACIÓN DEL PROYECTO - ACTUALIZACIÓN 31/10/2025

1. OBJETIVOS COMPLETADOS:
✅ Base de datos MySQL implementada
✅ Hosting en la nube (Render.com)
✅ Despliegue inicial del proyecto

2. OBJETIVOS PENDIENTES:
❌ Configuración de dominio personalizado
❌ Implementación de servicios de mensajería

3. DIFERENCIAS DE ENTORNO:

LINUX (TU CONFIGURACIÓN):
- MySQL en Podman
- Host: 127.0.0.1
- Puerto: 3306
- Usuario: root
- Contraseña: root

WINDOWS (CONFIGURACIÓN DE TU COMPAÑERO):
- MySQL en XAMPP/WAMP
- Host: localhost
- Puerto: 3306
- Usuario: root
- Contraseña: [vacía por defecto]

4. CAMBIOS REALIZADOS HOY:
a) Configuración de base de datos:
   - Creación de la base de datos 'reportes_db'
   - Implementación de tabla 'reporte'
   - Migración de Excel a MySQL

b) Configuración del despliegue:
   - Hosting: Render.com
   - URL: https://reportes-app.onrender.com
   - Configuración de variables de entorno

c) Dependencias actualizadas:
   - Flask y Werkzeug compatibles
   - SQLAlchemy versión específica para estabilidad

5. INSTRUCCIONES PARA WINDOWS:

a) Configurar el archivo .env:
```
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=
DB_NAME=reportes_db
```

b) Crear la base de datos en XAMPP/WAMP:
```sql
CREATE DATABASE reportes_db;
USE reportes_db;

CREATE TABLE reporte (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tipo VARCHAR(100) NOT NULL,
    descripcion TEXT NOT NULL,
    latitud FLOAT NOT NULL,
    longitud FLOAT NOT NULL,
    fecha_hora DATETIME DEFAULT CURRENT_TIMESTAMP,
    municipio VARCHAR(100) NOT NULL
);
```

6. PRÓXIMOS PASOS:
1. Configurar dominio personalizado
2. Implementar certificados SSL
3. Integrar servicios de mensajería
4. Pruebas de carga y rendimiento

7. NOTAS IMPORTANTES:
- La aplicación usa variables de entorno para la configuración
- Se mantienen dos archivos: .env (local) y .env.example (template)
- El proyecto está en GitHub: https://github.com/Mercodn/Comunicaciondedatos
- La versión gratuita de Render tiene limitaciones de inactividad

8. SOLUCIÓN DE PROBLEMAS:
- Si hay problemas de conexión, verificar configuración MySQL
- Para problemas de dependencias, usar versions.txt
- En caso de error 500, revisar logs de la aplicación

CONTACTO:
Para dudas o aclaraciones, consultar el repositorio o contactar al equipo.

--------------------
Última actualización: 31/10/2025


--------------------
ACTUALIZACIÓN ADICIONAL — 06/11/2025

Cambios y progresos (resumen técnico)
- Wireframes y vistas:
  - Añadidas plantillas: templates/login.html, templates/dashboard.html, templates/admin_dashboard.html.
  - Añadidos assets: static/css/wireframe.css, static/js/dashboard.js.
- Backend / infra:
  - app.py: carga robusta de GeoJSON, logging con RotatingFileHandler, rutas para wireframes, comandos CLI para migraciones.
  - migrations scaffold: scripts/manage_migrations.py (scaffold).
  - extensions.py para instancia db y ruptura de import circular.
- Configuración y tooling:
  - requirements.txt actualizado (Flask‑Migrate, pytest, pin cryptography).
  - .env.example y .gitignore añadidos.
  - Contenedor MySQL (podman) iniciado localmente (nombre: mysql-temp) para pruebas.
- Verificación:
  - db.create_all funciona localmente con la base reportes_db.
  - Endpoints principales disponibles: /, /reportar (POST), /obtener_reportes, /lista, /health.

Estado actual respecto a objetivos generales (06/11/2025)
- Hecho:
  - Arquitectura cliente‑servidor 3‑tier (Frontend estático + Flask backend + MySQL).
  - Persistencia y modelos base (models.py) y create_all funcionando.
  - Wireframes básicos y assets añadidos.
  - Logging y manejo básico de errores.
- Parcial:
  - Modelo de dominio: entidades creadas, faltan FKs/índices, diagrama ER.
  - Migraciones: Flask‑Migrate integrado; migraciones aún por generar/aplicar.
  - Modelo de comportamiento: endpoints implementados; faltan diagramas de secuencia y casos de uso.
- Nada:
  - XMPP/TLS (servidor y bot) no implementado.
  - Certificado de dominio y configuración nginx/certbot no aplicados.
  - Tests y CI no implementados aún.

Acciones recomendadas (siguientes pasos inmediatos)
1. Generar migraciones y aplicarlas:
   export FLASK_APP=app.py
   flask db migrate -m "Initial"
   flask db upgrade
2. Revisar y mejorar models.py (FKs, relaciones, índices) y volver a migrar.
3. Commit y push de los cambios: git add . && git commit -m "feat: add wireframes, assets, migration scaffold, docs" && git push
4. Implementar certificados y nginx en entorno de staging/producción.
5. Diseñar diagramas ER y secuencia (PlantUML) basados en wireframe y modelos.

Comandos útiles para commit y push (ejecutar desde el proyecto)
```
cd /home/leo/Documentos/codigo/Visual\ Code/
# asegurar .env ignorado
grep -Fxq ".env" .gitignore || echo ".env" >> .gitignore
git rm --cached .env || true

# añadir y commitear
git add templates/ static/ app.py requirements.txt .env.example scripts/ docs/ DOCUMENTACION.txt
git commit -m "docs: actualizar DOCUMENTACION con estado 06/11/2025; add wireframes and assets"
git push origin main
```

--------------------
Actualización registrada: 06/11/2025


--------------------


# ------------------------------------------------------------
# Nuevo bloque: Estado del proyecto — Resumen (06/11/2025)
# ------------------------------------------------------------

Fecha: 6 de noviembre de 2025

## Estructura relevante (resumen)
- app.py
- models.py
- extensions.py
- requirements.txt
- templates/
  - index.html
  - lista.html
  - login.html
  - dashboard.html
  - admin_dashboard.html
- static/
  - css/wireframe.css
  - js/dashboard.js
  - sabana_centro.geojson
- scripts/
  - manage_migrations.py (scaffold)
- migrations/ (posible)
- .env.example
- .gitignore
- docs/ (este archivo)

---

## Estado por objetivos generales (1..10)

1) Revisar documentación para Wireframe (login, usuario, analíticas, inicio de sesión, cantidad reportes, ubicación)
- Estado: Hecho
- Hecho: Rutas y plantillas wireframe creadas y completadas:
  - templates/login.html (login básico)
  - templates/reportar.html (formulario funcional con geolocalización y validación)
  - templates/dashboard.html (KPIs y lista)
  - templates/admin_dashboard.html
  - static/js/reportar.js (envío JSON al endpoint /reportar)
  - static/js/dashboard.js (consumo de /obtener_reportes)
- Notas: formulario de reporte obtiene lat/long desde el navegador y envía JSON; el backend responde con municipio detectado. Falta pulir textos UX y pruebas con usuarios.

3) Revisar que el sitio use los protocolos XMPP y TLS
- Estado: Nada
- Hecho: propuesta y plan en comentarios.
- Falta: desplegar servidor XMPP (prosody/ejabberd) y cliente/bot; configurar TLS para XMPP y HTTP.

4) Implementar certificado de dominio en el sitio (incluye la configuración)
- Estado: Nada
- Hecho: ejemplos de nginx + certbot en documentación propuesta.
- Falta: nginx config, certbot en servidor o proxy con Let's Encrypt.

6) Revisar qué es el modelo de dominio
- Estado: Parcial
- Hecho: models.py incluye Reporte, User, Municipio, LogEntry.
- Falta: documentar ER formal (diagrama), revisar FKs/índices y normalización.

7) Modelo de comportamiento
- Estado: Parcial
- Hecho: endpoints (reportar, obtener_reportes, lista, login placeholder).
- Falta: diagramas de secuencia y casos de uso por rol.

8) Diagramas de análisis (basado en wireframe / usuario)
- Estado: Nada
- Falta: PlantUML / draw.io con casos de uso y secuencias.

9) Modelo de clases (revisión)
- Estado: Parcial
- Hecho: clases ORM implementadas.
- Falta: ajustar relaciones, constraints, índices y generar migración.

10) Tipo de arquitectura cliente-servidor
- Estado: Hecho
- Hecho: arquitectura 3‑tier (Frontend estático + Flask backend + MySQL). Documentar diagrama de despliegue pendiente.

---

## Progresos de hoy (acciones completadas)
- Añadidas plantillas wireframe: `templates/login.html`, `templates/dashboard.html`, `templates/admin_dashboard.html`.
- Añadidos assets: `static/css/wireframe.css`, `static/js/dashboard.js`.
- Inicialización y correcciones en `app.py`:
  - carga de GeoJSON con validaciones,
  - logging con RotatingFileHandler (directorio `logs/` asegurado),
  - rutas nuevas para wireframes,
  - CLI helper commands para migraciones (`init_db`, `create_migration`, `migrate_db`).
- Evitada import circular moviendo `db` a `extensions.py` y usando `db.init_app(app)`.
- Requirements actualizados y `.env.example` + `.gitignore` añadidos.
- Contenedor MySQL (podman) levantado en local para pruebas.

---

## Archivos añadidos/modificados hoy
- templates/login.html
- templates/dashboard.html
- templates/admin_dashboard.html
- static/css/wireframe.css
- static/js/dashboard.js
- docs/PROJECT_STATUS.md (este archivo)
- .env.example
- .gitignore
- app.py (actualizaciones)
- requirements.txt (pins / Flask-Migrate)
- scripts/manage_migrations.py (scaffold)
- extensions.py, models.py (previos cambios)

---

## Pasos recomendados antes de push
1. Verificar que `.env` no esté en el índice:
   - `git status` — si `.env` aparece, ejecutar:
     - `echo ".env" >> .gitignore`
     - `git rm --cached .env`
     - `git add .gitignore`
     - `git commit -m "chore: ignore .env"`
2. Ejecutar tests/local smoke (opcional).
3. Commit y push de los cambios (comandos abajo).

## Comandos para commitear y pushear
```bash
# desde el proyecto
cd /home/leo/Documentos/codigo/Visual\ Code/

# comprobar estado
git status --porcelain

# asegurar .env ignorado (si no lo está)
grep -Fxq ".env" .gitignore || echo ".env" >> .gitignore
git rm --cached .env || true
git add .gitignore

# añadir cambios nuevos
git add templates/ static/ app.py requirements.txt .env.example scripts/ extensions.py models.py docs/PROJECT_STATUS.md DOCUMENTACION.txt

# commit (mensaje sugerido)
git commit -m "feat: add wireframe templates + assets; update app logging and migration scaffold; add docs and .env.example"

# push
git push origin main
```

--------------------
Fin de actualización: 06/11/2025